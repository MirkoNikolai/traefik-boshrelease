---
name: traefik

description: This job runs a Traefik reverse-proxy.

templates:
  bin/traefik_ctl: bin/traefik_ctl
  bin/bpm-prestart: bin/bpm-prestart
  bin/dns/healthy: bin/dns/healthy
  bpm.yml: config/bpm.yml
  conf/traefik.yml: conf/traefik.yml
  tls/01.crt: tls/01.crt
  tls/01.key: tls/01.key
  tls/02.crt: tls/02.crt
  tls/02.key: tls/02.key
  tls/03.crt: tls/03.crt
  tls/03.key: tls/03.key
  tls/04.crt: tls/04.crt
  tls/04.key: tls/04.key
  tls/05.crt: tls/05.crt
  tls/05.key: tls/05.key

packages:
  - traefik

provides:
  - name: traefik
    type: traefik
    properties:
      - traefik.conf
      
properties:
  bpm.enabled:
    description: |
      Switch to BPM (Bosh Process Manager) for running Traefik. This brings
      the benefit of improved security measures at runtime.
    default: false

  traefik.config:
    description: |
      This is a bosh release as single instance. So provide unter traefik.conf 
      property the full configuration

      default: false
  
  traefik.tls.crt.01:
    description: |
      copy the tls.crt.01 to ../conf/tls/01.crt

      default: false

  traefik.tls.crt.02:
    description: |
      copy the tls.crt.02 to ../conf/tls/02.crt

      default: false

  traefik.tls.crt.03:
    description: |
      copy the tls.crt.03 to ../conf/tls/03.crt

      default: false

  traefik.tls.crt.04:
    description: |
      copy the tls.crt.04 to ../conf/tls/04.crt

      default: false

  traefik.tls.crt.05:
    description: |
      copy the tls.crt.05 to ../conf/tls/05.crt

      default: false

  traefik.tls.key.01:
    description: |
      copy the tls.key.01 to ../conf/tls/01.key

      default: false

  traefik.tls.key.02:
    description: |
      copy the tls.key.02 to ../conf/tls/02.key

      default: false

  traefik.tls.key.03:
    description: |
      copy the tls.key.03 to ../conf/tls/03.key

      default: false

  traefik.tls.key.04:
    description: |
      copy the tls.key.04 to ../conf/tls/04.key

      default: false

  traefik.tls.key.05:
    description: |
      copy the tls.key.05 to ../conf/tls/05.crt

      default: false
